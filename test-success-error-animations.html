<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Success/Error Handling & Animations Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 40px;
            background: #f8fafc;
        }
        
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }
        
        h1 {
            color: #1f2937;
            margin-bottom: 8px;
        }
        
        .subtitle {
            color: #6b7280;
            margin-bottom: 32px;
            font-size: 18px;
        }
        
        .test-section {
            margin-bottom: 24px;
            padding: 20px;
            background: #f9fafb;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
        }
        
        .test-section h2 {
            color: #374151;
            margin-bottom: 12px;
            font-size: 18px;
        }
        
        .test-section p {
            color: #6b7280;
            margin-bottom: 12px;
        }
        
        .test-btn {
            padding: 10px 16px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            background: #00C2A8;
            color: white;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s ease;
            margin-right: 8px;
            margin-bottom: 8px;
        }
        
        .test-btn:hover {
            background: #00a58e;
        }
        
        .test-btn.secondary {
            background: #6b7280;
        }
        
        .test-btn.secondary:hover {
            background: #4b5563;
        }
        
        .test-btn.danger {
            background: #ef4444;
        }
        
        .test-btn.danger:hover {
            background: #dc2626;
        }
        
        .feature-list {
            background: #f0fdf4;
            border: 1px solid #bbf7d0;
            border-radius: 6px;
            padding: 16px;
            margin-bottom: 24px;
        }
        
        .feature-list h3 {
            color: #166534;
            margin-bottom: 8px;
            font-size: 16px;
        }
        
        .feature-list ul {
            color: #166534;
            margin: 0;
            padding-left: 20px;
        }
        
        .feature-list li {
            margin-bottom: 4px;
        }
        
        .test-results {
            background: #f3f4f6;
            padding: 12px;
            border-radius: 6px;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .instructions {
            background: #fef3c7;
            border: 1px solid #f59e0b;
            border-radius: 6px;
            padding: 16px;
            margin-bottom: 24px;
        }
        
        .instructions h3 {
            color: #92400e;
            margin-bottom: 8px;
            font-size: 16px;
        }
        
        .instructions ol {
            color: #92400e;
            margin: 0;
            padding-left: 20px;
        }
        
        .instructions li {
            margin-bottom: 4px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ¬ Success/Error Handling & Animations Test</h1>
        <p class="subtitle">Test all enhanced success/error handling features with animations</p>
        
        <div class="feature-list">
            <h3>âœ¨ Enhanced Features Implemented</h3>
            <ul>
                <li><strong>Success Animation:</strong> Slide-in animation with fade effects</li>
                <li><strong>Error Animation:</strong> Slide-in with pulse animation for attention</li>
                <li><strong>Loading Animation:</strong> Enhanced button states with pulse effect</li>
                <li><strong>Form Transitions:</strong> Smooth fade-out/fade-in between states</li>
                <li><strong>Network Error Handling:</strong> Progressive retry with visual feedback</li>
                <li><strong>Timeout Handling:</strong> 30-second timeout with retry logic</li>
                <li><strong>Graceful Degradation:</strong> Fallback animations for older browsers</li>
                <li><strong>Custom Events:</strong> successShown, errorShown events</li>
            </ul>
        </div>
        
        <div class="instructions">
            <h3>ğŸ§ª Test Instructions</h3>
            <ol>
                <li>Use the buttons below to test different animation scenarios</li>
                <li>Watch for smooth transitions between form, success, and error states</li>
                <li>Observe loading animations during submission</li>
                <li>Check that panel height remains consistent</li>
                <li>Test network error handling with retry animations</li>
            </ol>
        </div>
        
        <div class="test-section">
            <h2>ğŸ¯ Animation Tests</h2>
            <p>Test the enhanced animations for success and error states:</p>
            <button class="test-btn" onclick="testSuccessAnimation()">âœ… Test Success Animation</button>
            <button class="test-btn danger" onclick="testErrorAnimation()">âŒ Test Error Animation</button>
            <button class="test-btn secondary" onclick="testLoadingAnimation()">â³ Test Loading Animation</button>
            <button class="test-btn secondary" onclick="resetWidget()">ğŸ”„ Reset Widget</button>
        </div>
        
        <div class="test-section">
            <h2>ğŸŒ Network Error Handling</h2>
            <p>Test network error handling with retry logic:</p>
            <button class="test-btn" onclick="testNetworkError()">ğŸŒ Test Network Error</button>
            <button class="test-btn" onclick="testTimeoutError()">â±ï¸ Test Timeout Error</button>
            <button class="test-btn" onclick="testRetryLogic()">ğŸ”„ Test Retry Logic</button>
        </div>
        
        <div class="test-section">
            <h2>ğŸ“ Real Form Submission</h2>
            <p>Test with actual form submission to see all animations in sequence:</p>
            <button class="test-btn" onclick="testRealSubmission()">ğŸ“¤ Test Real Submission</button>
            <button class="test-btn" onclick="testValidationError()">ğŸš« Test Validation Error</button>
        </div>
        
        <div class="test-section">
            <h2>ğŸ›ï¸ Widget Controls</h2>
            <p>Basic widget controls:</p>
            <button class="test-btn" onclick="FeedbackWidget.open()">ğŸ“‚ Open Widget</button>
            <button class="test-btn" onclick="FeedbackWidget.close()">ğŸ“ Close Widget</button>
            <button class="test-btn" onclick="FeedbackWidget.toggle()">ğŸ”„ Toggle Widget</button>
        </div>
        
        <div class="test-section">
            <h2>ğŸ“Š Test Results</h2>
            <div id="test-results" class="test-results">
                <div style="color: #6b7280;">Test results will appear here...</div>
            </div>
        </div>
    </div>

    <!-- Load the feedback widget -->
    <script src="widget.js"></script>
    <script>
        // Initialize the widget
        FeedbackWidget.init({
            position: 'bottom-right',
            primaryColor: '#00C2A8',
            title: 'Animation Test',
            placeholder: 'Test the enhanced animations...',
            showName: true,
            showEmail: true
        });

        function logTestResult(message) {
            const testResults = document.getElementById('test-results');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.style.color = '#374151';
            logEntry.style.marginBottom = '4px';
            logEntry.innerHTML = `<span style="color: #6b7280;">[${timestamp}]</span> ${message}`;
            
            // Clear placeholder text
            if (testResults.children.length === 1 && testResults.children[0].textContent.includes('Test results will appear here')) {
                testResults.innerHTML = '';
            }
            
            testResults.appendChild(logEntry);
            testResults.scrollTop = testResults.scrollHeight;
            
            // Keep only last 15 entries
            while (testResults.children.length > 15) {
                testResults.removeChild(testResults.firstChild);
            }
        }

        // Test functions
        function testSuccessAnimation() {
            logTestResult('ğŸ¬ Testing success animation...');
            FeedbackWidget.open();
            
            setTimeout(() => {
                // Simulate success state with animation
                const form = document.getElementById('feedback-widget-form');
                const success = document.getElementById('feedback-widget-success');
                const panelContent = document.querySelector('.feedback-widget-panel-content');
                
                if (form && success && panelContent) {
                    const currentHeight = panelContent.offsetHeight;
                    
                    // Hide form with fade out
                    form.style.transition = 'opacity 0.2s ease, transform 0.2s ease';
                    form.style.opacity = '0';
                    form.style.transform = 'translateY(-10px)';
                    
                    setTimeout(() => {
                        form.style.display = 'none';
                        form.style.visibility = 'hidden';
                        
                        // Show success with slide-in animation
                        success.style.animation = 'none';
                        success.style.opacity = '0';
                        success.style.transform = 'translateY(20px)';
                        success.style.display = 'block';
                        success.style.visibility = 'visible';
                        
                        // Maintain panel height
                        panelContent.style.height = `${currentHeight}px`;
                        panelContent.style.justifyContent = 'center';
                        panelContent.style.alignItems = 'center';
                        
                        setTimeout(() => {
                            success.style.transition = 'opacity 0.4s ease, transform 0.4s ease';
                            success.style.animation = 'slideInUp 0.4s ease-out forwards';
                            success.style.opacity = '1';
                            success.style.transform = 'translateY(0)';
                        }, 50);
                    }, 200);
                    
                    logTestResult('âœ… Success animation triggered - observe slide-in effect');
                } else {
                    logTestResult('âŒ Could not find widget elements');
                }
            }, 500);
        }

        function testErrorAnimation() {
            logTestResult('ğŸ¬ Testing error animation...');
            FeedbackWidget.open();

            setTimeout(() => {
                // Simulate error state with animation
                const form = document.getElementById('feedback-widget-form');
                const error = document.getElementById('feedback-widget-error');
                const errorText = document.getElementById('feedback-widget-error-text');
                const panelContent = document.querySelector('.feedback-widget-panel-content');

                if (form && error && errorText && panelContent) {
                    const currentHeight = panelContent.offsetHeight;

                    // Hide form with fade out
                    form.style.transition = 'opacity 0.2s ease, transform 0.2s ease';
                    form.style.opacity = '0';
                    form.style.transform = 'translateY(-10px)';

                    setTimeout(() => {
                        form.style.display = 'none';
                        form.style.visibility = 'hidden';

                        // Show error with slide-in and pulse animation
                        errorText.textContent = 'Test error message with enhanced animations';
                        error.style.animation = 'none';
                        error.style.opacity = '0';
                        error.style.transform = 'translateY(20px)';
                        error.style.display = 'block';
                        error.style.visibility = 'visible';

                        // Maintain panel height
                        panelContent.style.height = `${currentHeight}px`;
                        panelContent.style.justifyContent = 'center';
                        panelContent.style.alignItems = 'center';

                        setTimeout(() => {
                            error.style.transition = 'opacity 0.4s ease, transform 0.4s ease';
                            error.style.animation = 'slideInUp 0.4s ease-out forwards, pulse 0.6s ease-in-out';
                            error.style.opacity = '1';
                            error.style.transform = 'translateY(0)';
                        }, 50);
                    }, 200);

                    logTestResult('âŒ Error animation triggered - observe slide-in with pulse effect');
                } else {
                    logTestResult('âŒ Could not find widget elements');
                }
            }, 500);
        }

        function testLoadingAnimation() {
            logTestResult('â³ Testing loading animation...');
            FeedbackWidget.open();

            setTimeout(() => {
                const submitBtn = document.getElementById('feedback-widget-submit');
                const submitText = submitBtn?.querySelector('.feedback-widget-submit-text');
                const loadingIcon = submitBtn?.querySelector('.feedback-widget-loading');

                if (submitBtn && submitText && loadingIcon) {
                    // Trigger loading state
                    submitBtn.disabled = true;
                    submitBtn.style.opacity = '0.8';
                    submitBtn.style.transform = 'scale(0.98)';

                    // Fade out text
                    submitText.style.transition = 'opacity 0.2s ease';
                    submitText.style.opacity = '0';
                    setTimeout(() => {
                        submitText.style.display = 'none';

                        // Fade in loading icon
                        loadingIcon.style.display = 'inline-flex';
                        loadingIcon.style.opacity = '0';
                        loadingIcon.style.transform = 'scale(0.8)';
                        setTimeout(() => {
                            loadingIcon.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
                            loadingIcon.style.opacity = '1';
                            loadingIcon.style.transform = 'scale(1)';
                        }, 100);
                    }, 200);

                    // Add pulse animation
                    submitBtn.style.animation = 'pulse 2s ease-in-out infinite';

                    logTestResult('â³ Loading animation triggered - observe button pulse and spinner');

                    // Reset after 3 seconds
                    setTimeout(() => {
                        submitBtn.disabled = false;
                        submitBtn.style.opacity = '1';
                        submitBtn.style.transform = 'scale(1)';
                        submitBtn.style.animation = 'none';

                        loadingIcon.style.opacity = '0';
                        setTimeout(() => {
                            loadingIcon.style.display = 'none';
                            submitText.style.display = 'inline';
                            submitText.style.opacity = '1';
                        }, 200);

                        logTestResult('âœ… Loading animation completed');
                    }, 3000);
                } else {
                    logTestResult('âŒ Could not find submit button elements');
                }
            }, 500);
        }

        function testNetworkError() {
            logTestResult('ğŸŒ Testing network error handling...');
            // This would require actual network failure simulation
            logTestResult('â„¹ï¸ Network error test requires actual network failure or backend modification');
        }

        function testTimeoutError() {
            logTestResult('â±ï¸ Testing timeout error handling...');
            // This would require backend delay simulation
            logTestResult('â„¹ï¸ Timeout test requires backend delay simulation (30+ seconds)');
        }

        function testRetryLogic() {
            logTestResult('ğŸ”„ Testing retry logic...');
            // This would require invalid endpoint
            logTestResult('â„¹ï¸ Retry logic test requires invalid endpoint configuration');
        }

        function testRealSubmission() {
            logTestResult('ğŸ“¤ Testing real form submission...');
            FeedbackWidget.open();

            setTimeout(() => {
                const commentField = document.getElementById('feedback-widget-comment');
                const nameField = document.getElementById('feedback-widget-name');
                const emailField = document.getElementById('feedback-widget-email');

                if (commentField) commentField.value = 'Test submission with enhanced animations';
                if (nameField) nameField.value = 'Animation Tester';
                if (emailField) emailField.value = 'test@animations.com';

                // Trigger form submission
                const form = document.getElementById('feedback-widget-form');
                if (form) {
                    const submitEvent = new Event('submit', { bubbles: true, cancelable: true });
                    form.dispatchEvent(submitEvent);
                    logTestResult('ğŸ“¤ Real submission triggered - watch for loading â†’ success animations');
                }
            }, 500);
        }

        function testValidationError() {
            logTestResult('ğŸš« Testing validation error...');
            FeedbackWidget.open();

            setTimeout(() => {
                // Try to submit empty form to trigger validation
                const form = document.getElementById('feedback-widget-form');
                if (form) {
                    const submitEvent = new Event('submit', { bubbles: true, cancelable: true });
                    form.dispatchEvent(submitEvent);
                    logTestResult('ğŸš« Validation error triggered - check for field error animations');
                }
            }, 500);
        }

        function resetWidget() {
            logTestResult('ğŸ”„ Resetting widget...');
            const form = document.getElementById('feedback-widget-form');
            const success = document.getElementById('feedback-widget-success');
            const error = document.getElementById('feedback-widget-error');
            const panelContent = document.querySelector('.feedback-widget-panel-content');

            if (form) {
                form.style.display = 'block';
                form.style.visibility = 'visible';
                form.style.opacity = '1';
                form.style.transform = 'translateY(0)';
                form.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
            }
            if (success) {
                success.style.display = 'none';
                success.style.visibility = 'hidden';
                success.style.animation = 'none';
            }
            if (error) {
                error.style.display = 'none';
                error.style.visibility = 'hidden';
                error.style.animation = 'none';
            }
            if (panelContent) {
                panelContent.style.height = '';
                panelContent.style.justifyContent = '';
                panelContent.style.alignItems = '';
            }

            logTestResult('âœ… Widget reset to initial state');
        }

        // Event listeners for widget events
        window.addEventListener('feedbackWidget:successShown', function(e) {
            logTestResult(`ğŸ‰ Success animation event: animated=${e.detail.animated}, duration=${e.detail.duration}ms`);
        });

        window.addEventListener('feedbackWidget:errorShown', function(e) {
            logTestResult(`âš ï¸ Error animation event: animated=${e.detail.animated}, message="${e.detail.message}"`);
        });

        window.addEventListener('feedbackWidget:submitted', function(e) {
            logTestResult(`âœ… Form submitted successfully after ${e.detail.attempt || 1} attempt(s)`);
        });

        window.addEventListener('feedbackWidget:submitError', function(e) {
            logTestResult(`âŒ Form submission failed: ${e.detail.error} (${e.detail.attempts || 1} attempts)`);
        });

        // Initial log
        logTestResult('ğŸš€ Success/Error animations test initialized');
        logTestResult('â„¹ï¸ All enhanced animation features are ready for testing');
    </script>
</body>
</html>
